<!-- Loader Overlay -->
<div class="loader-overlay" *ngIf="isLoading">
  <div class="loader-text text">
    <div class="spinner-border text-light me-2" role="status"></div>
    Saving your Projects Details, Please Wait...
  </div>
</div>

<!-- ------------------ Projects Section ------------------ -->
<h4 class="mb-3 d-flex justify-content-between align-items-center">
  <span><i class="bi bi-braces"></i> Projects</span>
  <button type="button" class="btn btn-dark btn-sm" (click)="addProject()">
    <i class="bi bi-plus-lg"></i> Add Project
  </button>
</h4>

<div *ngFor="let project of projects; let i = index; trackBy: trackByIndex" class="border rounded p-3 mb-3">
  <h5>Project {{ i + 1 }}</h5>

  <div class="mb-3">
    <label class="form-label">Project Name</label>
    <input type="text" class="form-control" [(ngModel)]="project.projectName" name="projectName{{i}}">
  </div>

  <div class="mb-3">
    <label class="form-label">Project Type</label>
    <input type="text" class="form-control" [(ngModel)]="project.projectType" name="projectType{{i}}">
  </div>

  <div class="mb-3">
    <label class="form-label">Project Description</label>
    <textarea class="form-control" [(ngModel)]="project.projectDescription" name="projectDescription{{i}}" rows="3"></textarea>
  </div>

  <!-- Project Screenshot -->
  <div class="mb-3">
    <label class="form-label fw-semibold">Project Screenshot</label>
    <input type="file" class="form-control" accept="image/*" (change)="onFileSelected($event, 'projectScreenshot', i)">
    <div *ngIf="project.screenshotPreview" class="mt-3">
      <img [src]="project.screenshotPreview" alt="Project Screenshot" class="img-thumbnail" width="200">
    </div>
  </div>

  <div class="mb-3">
    <label>GitHub Link</label>
    <input type="url" [(ngModel)]="project.github" name="github{{i}}" class="form-control" placeholder="https://github.com/your-repo">
  </div>

  <div class="mb-3">
    <label>Live Link</label>
    <input type="url" [(ngModel)]="project.live" name="live{{i}}" class="form-control" placeholder="https://your-live-site.com">
  </div>

  <!-- Project Skills -->
  <div *ngFor="let skill of project.projectSkills; let k = index; trackBy: trackByIndex" class="input-group mb-2">
    <input type="text" class="form-control" [(ngModel)]="project.projectSkills[k]" name="projectSkill{{i}}{{k}}" placeholder="Skill {{k+1}}">
    <button type="button" class="btn btn-dark" (click)="removeProjectSkill(i, k)" *ngIf="project.projectSkills.length > 1">✖</button>
  </div>

  <button type="button" class="btn btn-sm btn-dark mb-3" (click)="addProjectSkill(i)">
    <i class="bi bi-plus-lg"></i> Add Project Skill
  </button>

  <div>
    <button type="button" class="btn btn-dark btn-sm" (click)="removeProject(i)">✖ Remove Project</button>
  </div>
</div>

<!-- Save Button -->
<div class="text-center mt-4">
  <button type="button" class="btn btn-dark px-5" [disabled]="isLoading" (click)="onSave()">
    <i class="bi bi-bookmark-fill"></i>
    <span *ngIf="!isLoading">Save Projects</span>
    <span *ngIf="isLoading">Saving...</span>
  </button>
</div>
